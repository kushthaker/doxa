webpackJsonp([1],{J4b1:function(e,r){},NHnr:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("7+uW"),s={render:function(){var e=this.$createElement,r=this._self._c||e;return r("div",{attrs:{id:"app"}},[r("router-view")],1)},staticRenderFns:[]};var o=t("VU/8")({name:"App"},s,!1,function(e){t("gsu9")},null,null).exports,a=t("/ocq"),i=t("NYxO"),u={data:function(){return{}},computed:Object(i.b)({users:function(e){return e.users}})},c={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e._m(0),e._v(" "),t("section",{staticClass:"section"},[t("div",{staticClass:"container"},e._l(e.users,function(r){return t("div",{key:r.id,staticClass:"card"},[t("div",{staticClass:"card-content"},[r?t("div",[t("p",{staticClass:"title"},[e._v("Name: "+e._s(r.username)+"; Email: "+e._s(r.email))]),e._v(" "),t("p",{staticClass:"detail"},[e._v("See this "),t("router-link",{attrs:{to:"maestro/"+r.id}},[e._v("maestro")])],1)]):e._e()])])}),0)])])},staticRenderFns:[function(){var e=this.$createElement,r=this._self._c||e;return r("section",{staticClass:"hero is-primary"},[r("div",{staticClass:"hero-body"},[r("div",{staticClass:"container has-text-centered"},[r("h2",{staticClass:"title"},[this._v("List of users")])])])])}]};var l=t("VU/8")(u,c,!1,function(e){t("J4b1")},"data-v-441005c8",null).exports;var m={computed:Object(i.b)({maestro:function(e){return e.userData},currentUser:function(e){return e.currentUser}}),beforeMount:function(){parseInt(this.$route.params.id);this.$store.dispatch("loadUser",this.currentUser).then(function(){})}},d={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.maestro?t("div",[t("h3",[e._v("The maestro is "),t("em",[e._v(e._s(e.maestro.username))])]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.maestro.username,expression:"maestro.username"}],attrs:{placeholder:"e.g. Callum John Killian Mitchell"},domProps:{value:e.maestro.username},on:{input:function(r){r.target.composing||e.$set(e.maestro,"username",r.target.value)}}}),e._v(" "),t("p",[e._v("The maestro's email is "),t("strong",[e._v(e._s(e.maestro.email))])]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.maestro.email,expression:"maestro.email"}],attrs:{placeholder:"e.g. maestro@fulfilled.maestro"},domProps:{value:e.maestro.email},on:{input:function(r){r.target.composing||e.$set(e.maestro,"email",r.target.value)}}})]):t("div",[e._v("\n    Loading...\n  ")])])},staticRenderFns:[]};var f=t("VU/8")(m,d,!1,function(e){t("WSX8")},"data-v-f0b41e9e",null).exports,p={computed:Object(i.b)({newUser:function(e){return e.newUser},formErrors:function(e){return e.formErrors}}),methods:{submitUser:function(){var e=this;this.$store.dispatch("registerNewUser").then(function(){e.formErrors||e.$router.push({name:"Home"})})}},beforeMount:function(){}},v={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.formErrors?t("ul",{staticClass:"error-messages"},e._l(e.formErrors,function(r){return t("li",[e._v("\n      "+e._s(r)+"\n    ")])}),0):e._e(),e._v(" "),t("form",{on:{submit:function(r){return r.preventDefault(),e.submitUser(r)}}},[t("p",[e._v("Username: "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.username,expression:"newUser.username"}],attrs:{placeholder:"realdonaldtrump"},domProps:{value:e.newUser.username},on:{input:function(r){r.target.composing||e.$set(e.newUser,"username",r.target.value)}}})]),e._v(" "),t("p",[e._v("Email address: "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.email,expression:"newUser.email"}],attrs:{placeholder:"maestro@fulfilled.ai"},domProps:{value:e.newUser.email},on:{input:function(r){r.target.composing||e.$set(e.newUser,"email",r.target.value)}}})]),e._v(" "),t("p",[e._v("Password: "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.password,expression:"newUser.password"}],attrs:{required:"",type:"password"},domProps:{value:e.newUser.password},on:{input:function(r){r.target.composing||e.$set(e.newUser,"password",r.target.value)}}})]),e._v(" "),t("p",[e._v("Confirm password: "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.newUser.confirm_password,expression:"newUser.confirm_password"}],attrs:{required:"",type:"password"},domProps:{value:e.newUser.confirm_password},on:{input:function(r){r.target.composing||e.$set(e.newUser,"confirm_password",r.target.value)}}})]),e._v(" "),t("button",[e._v("Register")])])])},staticRenderFns:[]},U=t("VU/8")(p,v,!1,null,null,null).exports,g={computed:Object(i.b)({loginUser:function(e){return e.loginUser},isLoggedIn:function(e){return e.isLoggedIn},formErrors:function(e){return e.formErrors}}),methods:{submitUser:function(){var e=this;return this.$store.dispatch("userLogin").then(function(){if(!e.formErrors){var r=e.$store.getters.currentUser;return e.$router.push({name:"Maestro",params:{id:r.id}},function(){}),r}})}}},h={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[e.formErrors?t("ul",{staticClass:"error-messages"},e._l(e.formErrors,function(r){return t("li",[e._v("\n      "+e._s(r)+"\n    ")])}),0):e._e(),e._v(" "),t("form",{on:{submit:function(r){return r.preventDefault(),e.submitUser(r)}}},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginUser.email,expression:"loginUser.email"}],attrs:{placeholder:"Your email address",required:""},domProps:{value:e.loginUser.email},on:{input:function(r){r.target.composing||e.$set(e.loginUser,"email",r.target.value)}}}),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:e.loginUser.password,expression:"loginUser.password"}],attrs:{placeholder:"Password",required:"",type:"password"},domProps:{value:e.loginUser.password},on:{input:function(r){r.target.composing||e.$set(e.loginUser,"password",r.target.value)}}}),e._v(" "),t("button",[e._v("Login")])])])},staticRenderFns:[]},w=t("VU/8")(g,h,!1,null,null,null).exports,_=t("BO1k"),C=t.n(_),E=t("fZjL"),b=t.n(E),k=t("mtWM"),F=t.n(k);function $(){return F.a.get("/api/get_csrf")}var R=t("ppUw"),S=t.n(R);n.a.use(i.a),n.a.use(S.a);var x={users:[],userData:{},newUser:{username:null,email:null,password:null,confirm_password:null,csrf_token:null},formErrors:null,loginUser:{email:null,password:null,csrf_token:null},currentUser:null,CSRFToken:null,jwt:""},N={loadUsers:function(e){return F.a.get("/api/users").then(function(r){return e.commit("setUsers",{users:r.data})})},loadUser:function(e,r){return(t=r,F.a.get("/api/user_details",{data:t,headers:{Authorization:"Bearer: "+t.token}})).then(function(r){r.data||e.commit("setUserData",{userData:{error:!0}}),e.commit("setUserData",{userData:r.data})}).catch(function(e){});var t},loadCSRF:function(e){return $().then(function(r){return e.commit("setCSRF",{CSRFToken:r.data.csrf_token})})},registerNewUser:function(e){var r;return x.newUser.csrf_token=x.CSRFToken,(r=x.newUser,F.a.post("/api/register",r)).then(function(r){e.commit("setNewUser",{newUser:x.newUser}),e.commit("setErrors",{errors:null})}).catch(function(r){$().then(function(r){return e.commit("setCSRF",{CSRFToken:r.data.csrf_token})});var t=D(r.response);e.commit("setErrors",{errors:t})})},userLogin:function(e){var r;return x.loginUser.csrf_token=x.CSRFToken,(r=x.loginUser,F.a.post("/api/login",r)).then(function(r){return e.commit("setCurrentUser",{currentUser:r.data}),e.commit("saveCurrentUser",{currentUser:r.data}),e.commit("setErrors",{errors:null}),e.commit("setJWT",{jwt:r.data.token})}).catch(function(r){$().then(function(r){return e.commit("setCSRF",{CSRFToken:r.data.csrf_token})});var t=D(r.response);e.commit("setErrors",{errors:t})})},clearFormErrors:function(e){x.formErrors=null},checkLogin:function(e){var r=$cookies.get("currentUser");return e.commit("setCurrentUser",{currentUser:r})}},y={setUsers:function(e,r){e.users=r.users},setUserData:function(e,r){e.userData=r.userData},setCSRF:function(e,r){e.CSRFToken=r.CSRFToken},setErrors:function(e,r){e.formErrors=r.errors},setNewUser:function(e,r){e.newUser=r.newUser},setJWT:function(e,r){e.jwt=r.jwt},setCurrentUser:function(e,r){e.currentUser=r.currentUser,r.currentUser?e.jwt=r.currentUser.token:e.jwt=""},saveCurrentUser:function(e,r){$cookies.set("currentUser",r.currentUser)}},j={isAuthenticated:function(e){return function(e){if(!e||e.split(".").length<3)return!1;var r=JSON.parse(atob(e.split(".")[1])),t=new Date(1e3*r.exp);return new Date<t}(e.jwt)},currentUser:function(e){return e.currentUser}};function D(e){var r,t=null;if(e.data.errors){var n=e.data.errors;t=[];var s=!0,o=!1,a=void 0;try{for(var i,u=C()((r=n,b()(r)));!(s=(i=u.next()).done);s=!0){var c=i.value,l=!0,m=!1,d=void 0;try{for(var f,p=C()(n[c]);!(l=(f=p.next()).done);l=!0){var v=f.value;t=t.concat(v)}}catch(e){m=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(m)throw d}}}}catch(e){o=!0,a=e}finally{try{!s&&u.return&&u.return()}finally{if(o)throw a}}}return t}var T=new i.a.Store({state:x,actions:N,mutations:y,getters:j});n.a.use(a.a);var L=new a.a({routes:[{path:"/",name:"Home",component:l,beforeEnter:function(e,r,t){T.dispatch("loadUsers").then(function(){t()})}},{path:"/maestro/:id",name:"Maestro",component:f,beforeEnter:function(e,r,t){var n=T.getters.isAuthenticated,s=T.getters.currentUser;n?s&&e.params.id===String(s.id)?t():t("/maestro/"+s.id):t("/login")}},{path:"/register-new-user",name:"Register",component:U,beforeEnter:function(e,r,t){T.dispatch("clearFormErrors"),T.dispatch("loadCSRF"),t()}},{path:"/login",name:"Login",component:w,beforeEnter:function(e,r,t){T.dispatch("clearFormErrors"),T.dispatch("loadCSRF"),t()}}]});L.beforeEach(function(e,r,t){T.dispatch("checkLogin").then(function(){t()})});var P=L;n.a.config.productionTip=!1,new n.a({el:"#app",router:P,store:T,components:{App:o},template:"<App/>"})},WSX8:function(e,r){},gsu9:function(e,r){}},["NHnr"]);
//# sourceMappingURL=app.22fe15cd7c173ea33d58.js.map